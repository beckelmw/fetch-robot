!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define("fetchRobot",[],r):"object"==typeof exports?exports.fetchRobot=r():e.fetchRobot=r()}("undefined"!=typeof self?self:this,function(){return function(e){function r(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,r),o.l=!0,o.exports}var n={};return r.m=e,r.c=n,r.d=function(e,n,t){r.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:t})},r.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(n,"a",n),n},r.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},r.p="",r(r.s="./src/index.js")}({"./node_modules/querystringify/index.js":function(e,r,n){"use strict";function t(e){return decodeURIComponent(e.replace(/\+/g," "))}function o(e){for(var r,n=/([^=?&]+)=?([^&]*)/g,o={};r=n.exec(e);o[t(r[1])]=t(r[2]));return o}function i(e,r){r=r||"";var n=[];"string"!=typeof r&&(r="?");for(var t in e)a.call(e,t)&&n.push(encodeURIComponent(t)+"="+encodeURIComponent(e[t]));return n.length?r+n.join("&"):""}var a=Object.prototype.hasOwnProperty;r.stringify=i,r.parse=o},"./node_modules/requires-port/index.js":function(e,r,n){"use strict";e.exports=function(e,r){if(r=r.split(":")[0],!(e=+e))return!1;switch(r){case"http":case"ws":return 80!==e;case"https":case"wss":return 443!==e;case"ftp":return 21!==e;case"gopher":return 70!==e;case"file":return!1}return 0!==e}},"./node_modules/url-parse/index.js":function(e,r,n){"use strict";(function(r){function t(e){e=e||r.location||{};var n,t={},o=void 0===e?"undefined":c(e);if("blob:"===e.protocol)t=new a(unescape(e.pathname),{});else if("string"===o){t=new a(e,{});for(n in w)delete t[n]}else if("object"===o){for(n in e)n in w||(t[n]=e[n]);void 0===t.slashes&&(t.slashes=h.test(e.href))}return t}function o(e){var r=d.exec(e);return{protocol:r[1]?r[1].toLowerCase():"",slashes:!!r[2],rest:r[3]}}function i(e,r){for(var n=(r||"/").split("/").slice(0,-1).concat(e.split("/")),t=n.length,o=n[t-1],i=!1,a=0;t--;)"."===n[t]?n.splice(t,1):".."===n[t]?(n.splice(t,1),a++):a&&(0===t&&(i=!0),n.splice(t,1),a--);return i&&n.unshift(""),"."!==o&&".."!==o||n.push(""),n.join("/")}function a(e,r,n){if(!(this instanceof a))return new a(e,r,n);var u,s,d,h,w,y,m=p.slice(),v=void 0===r?"undefined":c(r),E=this,_=0;for("object"!==v&&"string"!==v&&(n=r,r=null),n&&"function"!=typeof n&&(n=l.parse),r=t(r),s=o(e||""),u=!s.protocol&&!s.slashes,E.slashes=s.slashes||u&&r.slashes,E.protocol=s.protocol||r.protocol||"",e=s.rest,s.slashes||(m[2]=[/(.*)/,"pathname"]);_<m.length;_++)h=m[_],d=h[0],y=h[1],d!==d?E[y]=e:"string"==typeof d?~(w=e.indexOf(d))&&("number"==typeof h[2]?(E[y]=e.slice(0,w),e=e.slice(w+h[2])):(E[y]=e.slice(w),e=e.slice(0,w))):(w=d.exec(e))&&(E[y]=w[1],e=e.slice(0,w.index)),E[y]=E[y]||(u&&h[3]?r[y]||"":""),h[4]&&(E[y]=E[y].toLowerCase());n&&(E.query=n(E.query)),u&&r.slashes&&"/"!==E.pathname.charAt(0)&&(""!==E.pathname||""!==r.pathname)&&(E.pathname=i(E.pathname,r.pathname)),f(E.port,E.protocol)||(E.host=E.hostname,E.port=""),E.username=E.password="",E.auth&&(h=E.auth.split(":"),E.username=h[0]||"",E.password=h[1]||""),E.origin=E.protocol&&E.host&&"file:"!==E.protocol?E.protocol+"//"+E.host:"null",E.href=E.toString()}function u(e,r,n){var t=this;switch(e){case"query":"string"==typeof r&&r.length&&(r=(n||l.parse)(r)),t[e]=r;break;case"port":t[e]=r,f(r,t.protocol)?r&&(t.host=t.hostname+":"+r):(t.host=t.hostname,t[e]="");break;case"hostname":t[e]=r,t.port&&(r+=":"+t.port),t.host=r;break;case"host":t[e]=r,/:\d+$/.test(r)?(r=r.split(":"),t.port=r.pop(),t.hostname=r.join(":")):(t.hostname=r,t.port="");break;case"protocol":t.protocol=r.toLowerCase(),t.slashes=!n;break;case"pathname":case"hash":if(r){var o="pathname"===e?"/":"#";t[e]=r.charAt(0)!==o?o+r:r}else t[e]=r;break;default:t[e]=r}for(var i=0;i<p.length;i++){var a=p[i];a[4]&&(t[a[1]]=t[a[1]].toLowerCase())}return t.origin=t.protocol&&t.host&&"file:"!==t.protocol?t.protocol+"//"+t.host:"null",t.href=t.toString(),t}function s(e){e&&"function"==typeof e||(e=l.stringify);var r,n=this,t=n.protocol;t&&":"!==t.charAt(t.length-1)&&(t+=":");var o=t+(n.slashes?"//":"");return n.username&&(o+=n.username,n.password&&(o+=":"+n.password),o+="@"),o+=n.host+n.pathname,r="object"===c(n.query)?e(n.query):n.query,r&&(o+="?"!==r.charAt(0)?"?"+r:r),n.hash&&(o+=n.hash),o}var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f=n("./node_modules/requires-port/index.js"),l=n("./node_modules/querystringify/index.js"),d=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\S\s]*)/i,h=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,p=[["#","hash"],["?","query"],["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d+)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],w={hash:1,query:1};a.prototype={set:u,toString:s},a.extractProtocol=o,a.location=t,a.qs=l,e.exports=a}).call(r,n("./node_modules/webpack/buildin/global.js"))},"./node_modules/webpack/buildin/global.js":function(e,r){var n,t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"===("undefined"==typeof window?"undefined":t(window))&&(n=window)}e.exports=n},"./src/index.js":function(e,r,n){"use strict";function t(e){try{if(!e)return!1;if(window.Promise&&e instanceof window.Promise)return!0;if(window.Window&&e instanceof window.Window)return!1;if(window.constructor&&e instanceof window.constructor)return!1;var r={}.toString;if(r){var n=r.call(e);if("[object Window]"===n||"[object global]"===n||"[object DOMWindow]"===n)return!1}if("function"==typeof e.then)return!0}catch(e){return!1}return!1}function o(){return window.__zalgopromise__||(window.__zalgopromise__={flushPromises:[],activeCount:0,possiblyUnhandledPromiseHandlers:[],dispatchedErrors:[]}),window.__zalgopromise__}function i(e){if(-1===o().dispatchedErrors.indexOf(e)){o().dispatchedErrors.push(e),setTimeout(function(){throw e},1);for(var r=0;r<o().possiblyUnhandledPromiseHandlers.length;r++)o().possiblyUnhandledPromiseHandlers[r](e)}}function a(e){return o().possiblyUnhandledPromiseHandlers.push(e),{cancel:function(){o().possiblyUnhandledPromiseHandlers.splice(o().possiblyUnhandledPromiseHandlers.indexOf(e),1)}}}function u(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function s(){}function c(e){var r=e.location;if(!r)throw new Error("Can not read window location");var n=r.protocol;if(!n)throw new Error("Can not read window protocol");if(n===Sr.FILE_PROTOCOL)return Sr.FILE_PROTOCOL+"//";var t=r.host;if(!t)throw new Error("Can not read window host");return n+"//"+t}function f(e){e=e||window;var r=c(e);return r&&e.mockDomain&&0===e.mockDomain.indexOf(Sr.MOCK_PROTOCOL)?e.mockDomain:r}function l(e){try{if(!e.location.href)return!0;if("about:blank"===e.location.href)return!0}catch(e){}return!1}function d(e){try{var r=Object.getOwnPropertyDescriptor(e,"location");if(r&&!1===r.enumerable)return!1}catch(e){}try{if(l(e))return!0;if(c(e)===c(window))return!0}catch(e){}return!1}function h(e){if(!d(e))return!1;try{if(l(e))return!0;if(f(window)===f(e))return!0}catch(e){}return!1}function p(e){if(!e.contentWindow)return!0;if(!e.parentNode)return!0;var r=e.ownerDocument;return!(!r||!r.body||r.body.contains(e))}function w(e,r){for(var n=0;n<e.length;n++)try{if(e[n]===r)return n}catch(e){}return-1}function y(e){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];try{if(e===window)return!1}catch(e){return!0}try{if(!e)return!0}catch(e){return!0}try{if(e.closed)return!0}catch(e){return!e||e.message!==br}if(r&&h(e))try{if(e.mockclosed)return!0}catch(e){}try{if(!e.parent||!e.top)return!0}catch(e){}try{s(e===e)}catch(e){return!0}var n=w(Ar,e);if(-1!==n){var t=Pr[n];if(t&&p(t))return!0}return!1}function m(e){try{if(e===window)return!0}catch(e){if(e&&e.message===br)return!0}try{if("[object Window]"===Object.prototype.toString.call(e))return!0}catch(e){if(e&&e.message===br)return!0}try{if(window.Window&&e instanceof window.Window)return!0}catch(e){if(e&&e.message===br)return!0}try{if(e&&e.self===e)return!0}catch(e){if(e&&e.message===br)return!0}try{if(e&&e.parent===e)return!0}catch(e){if(e&&e.message===br)return!0}try{if(e&&e.top===e)return!0}catch(e){if(e&&e.message===br)return!0}try{s(e===e)}catch(e){return!0}try{s(e&&e.__cross_domain_utils_window_check__)}catch(e){return!0}return!1}function v(){if(!window.WeakMap)return!1;if(!window.Object.freeze)return!1;try{var e=new window.WeakMap,r={};return window.Object.freeze(r),e.set(r,"__testvalue__"),"__testvalue__"===e.get(r)}catch(e){return!1}}function E(e,r){for(var n=0;n<e.length;n++)try{if(e[n]===r)return n}catch(e){}return-1}function _(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function O(e){return"[object RegExp]"===Object.prototype.toString.call(e)}function g(){}function S(e){var r=e.location;if(!r)throw new Error("Can not read window location");var n=r.protocol;if(!n)throw new Error("Can not read window protocol");if(n===Ir.FILE_PROTOCOL)return Ir.FILE_PROTOCOL+"//";var t=r.host;if(!t)throw new Error("Can not read window host");return n+"//"+t}function b(e){e=e||window;var r=S(e);return r&&e.mockDomain&&0===e.mockDomain.indexOf(Ir.MOCK_PROTOCOL)?e.mockDomain:r}function A(e){try{if(!e.location.href)return!0;if("about:blank"===e.location.href)return!0}catch(e){}return!1}function P(e){try{var r=Object.getOwnPropertyDescriptor(e,"location");if(r&&!1===r.enumerable)return!1}catch(e){}try{if(A(e))return!0;if(S(e)===S(window))return!0}catch(e){}return!1}function T(e){if(!P(e))return!1;try{if(A(e))return!0;if(b(window)===b(e))return!0}catch(e){}return!1}function R(e){if(e)try{if(e.parent&&e.parent!==e)return e.parent}catch(e){return}}function k(e){if(e&&!R(e))try{return e.opener}catch(e){return}}function L(e){var r=[];try{for(;e.parent!==e;)r.push(e.parent),e=e.parent}catch(e){}return r}function I(e,r){if(!e||!r)return!1;var n=R(r);return n?n===e:-1!==L(r).indexOf(e)}function C(e){var r=[],n=void 0;try{n=e.frames}catch(r){n=e}var t=void 0;try{t=n.length}catch(e){}if(0===t)return r;if(t){for(var o=0;o<t;o++){var i=void 0;try{i=n[o]}catch(e){continue}r.push(i)}return r}for(var a=0;a<100;a++){var u=void 0;try{u=n[a]}catch(e){return r}if(!u)return r;r.push(u)}return r}function j(e){for(var r=[],n=C(e),t=Array.isArray(n),o=0,n=t?n:n[Symbol.iterator]();;){var i;if(t){if(o>=n.length)break;i=n[o++]}else{if(o=n.next(),o.done)break;i=o.value}var a=i;r.push(a);for(var u=j(a),s=Array.isArray(u),c=0,u=s?u:u[Symbol.iterator]();;){var f;if(s){if(c>=u.length)break;f=u[c++]}else{if(c=u.next(),c.done)break;f=c.value}var l=f;r.push(l)}}return r}function x(e){if(e){try{if(e.top)return e.top}catch(e){}if(R(e)===e)return e;try{if(I(window,e)&&window.top)return window.top}catch(e){}try{if(I(e,window)&&window.top)return window.top}catch(e){}for(var r=j(e),n=Array.isArray(r),t=0,r=n?r:r[Symbol.iterator]();;){var o;if(n){if(t>=r.length)break;o=r[t++]}else{if(t=r.next(),t.done)break;o=t.value}var i=o;try{if(i.top)return i.top}catch(e){}if(R(i)===i)return i}}}function D(e){if(!e.contentWindow)return!0;if(!e.parentNode)return!0;var r=e.ownerDocument;return!(!r||!r.body||r.body.contains(e))}function M(e,r){for(var n=0;n<e.length;n++)try{if(e[n]===r)return n}catch(e){}return-1}function W(e){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];try{if(e===window)return!1}catch(e){return!0}try{if(!e)return!0}catch(e){return!0}try{if(e.closed)return!0}catch(e){return!e||e.message!==Cr}if(r&&T(e))try{if(e.mockclosed)return!0}catch(e){}try{if(!e.parent||!e.top)return!0}catch(e){}try{g(e===e)}catch(e){return!0}var n=M(jr,e);if(-1!==n){var t=xr[n];if(t&&D(t))return!0}return!1}function N(e){e=e||window;var r=k(e);if(r)return r;var n=R(e);return n||void 0}function G(e,r){var n=N(r);if(n)return n===e;if(r===e)return!1;if(x(r)===r)return!1;for(var t=C(e),o=Array.isArray(t),i=0,t=o?t:t[Symbol.iterator]();;){var a;if(o){if(i>=t.length)break;a=t[i++]}else{if(i=t.next(),i.done)break;a=i.value}if(a===r)return!0}return!1}function q(){return Boolean(k(window))}function U(){return Boolean(R(window))}function H(e,r){if("string"==typeof e){if("string"==typeof r)return e===Ir.WILDCARD||r===e;if(O(r))return!1;if(Array.isArray(r))return!1}return O(e)?O(r)?e.toString()===r.toString():!Array.isArray(r)&&Boolean(r.match(e)):!!Array.isArray(e)&&(Array.isArray(r)?JSON.stringify(e)===JSON.stringify(r):!O(r)&&e.some(function(e){return H(e,r)}))}function Y(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function F(e){if(!e)return"<unknown error: "+Object.prototype.toString.call(e)+">";if("string"==typeof e)return e;if(e instanceof Error){var r=e&&e.stack,n=e&&e.message;if(r&&n)return-1!==r.indexOf(n)?r:n+"\n"+r;if(r)return r;if(n)return n}return"function"==typeof e.toString?e.toString():Object.prototype.toString.call(e)}function B(){}function K(e,r,n){return e.addEventListener?e.addEventListener(r,n):e.attachEvent("on"+r,n),{cancel:function(){e.removeEventListener?e.removeEventListener(r,n):e.detachEvent("on"+r,n)}}}function J(){var e="0123456789abcdef";return"xxxxxxxxxx".replace(/./g,function(){return e.charAt(Math.floor(Math.random()*e.length))})}function Z(e,r){for(var n=0;n<e.length;n++)r(e[n],n)}function z(e,r){for(var n in e)e.hasOwnProperty(n)&&r(e[n],n)}function Q(e,r){Array.isArray(e)?Z(e,r):"object"===(void 0===e?"undefined":Nr(e))&&null!==e&&z(e,r)}function X(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(n>=100)throw new Error("Self-referential object passed, or object contained too many layers");var t=void 0;if("object"!==(void 0===e?"undefined":Nr(e))||null===e||Array.isArray(e)){if(!Array.isArray(e))throw new Error("Invalid type: "+(void 0===e?"undefined":Nr(e)));t=[]}else t={};return Q(e,function(e,o){var i=r(e,o);void 0!==i?t[o]=i:"object"===(void 0===e?"undefined":Nr(e))&&null!==e?t[o]=X(e,r,n+1):t[o]=e}),t}function V(e,r){function n(){t=setTimeout(n,r),e.call()}var t=void 0;return t=setTimeout(n,r),{cancel:function(){clearTimeout(t)}}}function $(e){return"[object RegExp]"===Object.prototype.toString.call(e)}function ee(){return q()?Dr.WINDOW_TYPES.POPUP:U()?Dr.WINDOW_TYPES.IFRAME:Dr.WINDOW_TYPES.FULLPAGE}function re(e,r,n){var t=void 0,o=void 0;try{if("{}"!==JSON.stringify({})&&(t=Object.prototype.toJSON,delete Object.prototype.toJSON),"{}"!==JSON.stringify({}))throw new Error("Can not correctly serialize JSON objects");if("[]"!==JSON.stringify([])&&(o=Array.prototype.toJSON,delete Array.prototype.toJSON),"[]"!==JSON.stringify([]))throw new Error("Can not correctly serialize JSON objects")}catch(e){throw new Error("Can not repair JSON.stringify: "+e.message)}var i=JSON.stringify.call(this,e,r,n);try{t&&(Object.prototype.toJSON=t),o&&(Array.prototype.toJSON=o)}catch(e){throw new Error("Can not repair JSON.stringify: "+e.message)}return i}function ne(e){return JSON.parse(e)}function te(e,r){return"object"===(void 0===e?"undefined":Fr(e))&&null!==e&&e.__type__===r}function oe(e,r,n,t){var o=J(),i=Yr.methods.get(e);return i||(i={},Yr.methods.set(e,i)),i[o]={domain:r,method:n},{__type__:Dr.SERIALIZATION_TYPES.METHOD,__id__:o,__name__:t}}function ie(e){return{__type__:Dr.SERIALIZATION_TYPES.ERROR,__message__:F(e)}}function ae(e,r,n,t){return{__type__:Dr.SERIALIZATION_TYPES.PROMISE,__then__:oe(e,r,function(e,r){return n.then(e,r)},t+".then")}}function ue(e,r,n,t){return{__type__:Dr.SERIALIZATION_TYPES.ZALGO_PROMISE,__then__:oe(e,r,function(e,r){return n.then(e,r)},t+".then")}}function se(e){return{__type__:Dr.SERIALIZATION_TYPES.REGEX,__source__:e.source}}function ce(e,r,n){return X({obj:n},function(n,t){return"function"==typeof n?oe(e,r,n,t.toString()):n instanceof Error?ie(n):window.Promise&&n instanceof window.Promise?ae(e,r,n,t.toString()):gr.isPromise(n)?ue(e,r,n,t.toString()):$(n)?se(n):void 0}).obj}function fe(e,r,n){function t(){var t=Array.prototype.slice.call(arguments);return Hr.debug("Call foreign method",n.__name__,t),je(e,Dr.POST_MESSAGE_NAMES.METHOD,{id:n.__id__,name:n.__name__,args:t},{domain:r,timeout:1/0}).then(function(e){var r=e.data;return Hr.debug("Got foreign method result",n.__name__,r.result),r.result},function(e){throw Hr.debug("Got foreign method error",F(e)),e})}return t.__name__=n.__name__,t.__xdomain__=!0,t.source=e,t.origin=r,t}function le(e,r,n){return new Error(n.__message__)}function de(e,r,n){return new gr(function(t,o){return fe(e,r,n.__then__)(t,o)})}function he(e,r,n){return window.Promise?new window.Promise(function(t,o){return fe(e,r,n.__then__)(t,o)}):de(e,r,n)}function pe(e,r,n){return new RegExp(n.__source__)}function we(e,r,n){return X({obj:n},function(n,t){if("object"===(void 0===n?"undefined":Fr(n))&&null!==n)return te(n,Dr.SERIALIZATION_TYPES.METHOD)?fe(e,r,n):te(n,Dr.SERIALIZATION_TYPES.ERROR)?le(e,r,n):te(n,Dr.SERIALIZATION_TYPES.PROMISE)?he(e,r,n):te(n,Dr.SERIALIZATION_TYPES.ZALGO_PROMISE)?de(e,r,n):te(n,Dr.SERIALIZATION_TYPES.REGEX)?pe(e,r,n):void 0}).obj}function ye(){We(Dr.POST_MESSAGE_NAMES.READY,{domain:Dr.WILDCARD},function(e){var r=e.source,n=Yr.readyPromises.get(r);n?n.resolve(e):(n=(new gr).resolve(e),Yr.readyPromises.set(r,n))});var e=N();e&&je(e,Dr.POST_MESSAGE_NAMES.READY,{},{domain:Dr.WILDCARD,timeout:1/0}).catch(function(e){Hr.debug(F(e))})}function me(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Window",t=Yr.readyPromises.get(e);return t||(t=new gr,Yr.readyPromises.set(e,t),setTimeout(function(){return t.reject(new Error(n+" did not load after "+r+"ms"))},r),t)}function ve(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function Ee(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},t=J(),o=ee(),i=b(window);return Jr({},r,n,{sourceDomain:i,id:r.id||t,windowType:o})}function _e(e,r,n){return gr.try(function(){r=Ee(e,r,{data:ce(e,n,r.data),domain:n});var t=void 0;if(t=-1!==Mr.indexOf(r.name)||r.type===Dr.POST_MESSAGE_TYPE.ACK?"debug":"error"===r.ack?"error":"info",Hr.logLevel(t,["\n\n\t","#send",r.type.replace(/^postrobot_message_/,""),"::",r.name,"::",n||Dr.WILDCARD,"\n\n",r]),e===window)throw new Error("Attemping to send message to self");if(W(e))throw new Error("Window is closed");Hr.debug("Running send message strategies",r);var o=[],i=re(ve({},Dr.WINDOW_PROPS.POSTROBOT,r),null,2);return gr.map(Object.keys(Kr),function(r){return gr.try(function(){if(!Wr.ALLOWED_POST_MESSAGE_METHODS[r])throw new Error("Strategy disallowed: "+r);return Kr[r](e,i,n)}).then(function(){return o.push(r+": success"),!0},function(e){return o.push(r+": "+F(e)+"\n"),!1})}).then(function(e){var n=e.some(Boolean),t=r.type+" "+r.name+" "+(n?"success":"error")+":\n  - "+o.join("\n  - ")+"\n";if(Hr.debug(t),!n)throw new Error(t)})})}function Oe(e,r){Yr.responseListeners[e]=r}function ge(e){return Yr.responseListeners[e]}function Se(e){delete Yr.responseListeners[e]}function be(e){var r=e.name,n=e.win,t=e.domain;if(n===Dr.WILDCARD&&(n=null),t===Dr.WILDCARD&&(t=null),!r)throw new Error("Name required to get request listener");var o=Yr.requestListeners[r];if(o)for(var i=[n,Yr.WINDOW_WILDCARD],a=0;a<i.length;a++){var u=i[a],s=u&&o.get(u);if(s){if(t&&"string"==typeof t){if(s[t])return s[t];if(s[zr])for(var c=s[zr],f=Array.isArray(c),l=0,c=f?c:c[Symbol.iterator]();;){var d;if(f){if(l>=c.length)break;d=c[l++]}else{if(l=c.next(),l.done)break;d=l.value}var h=d,p=h.regex,w=h.listener;if(H(p,t))return w}}if(s[Dr.WILDCARD])return s[Dr.WILDCARD]}}}function Ae(e,r){var n=e.name,t=e.win,o=e.domain;if(!n||"string"!=typeof n)throw new Error("Name required to add request listener");if(Array.isArray(t)){for(var i=[],a=t,u=Array.isArray(a),s=0,a=u?a:a[Symbol.iterator]();;){var c;if(u){if(s>=a.length)break;c=a[s++]}else{if(s=a.next(),s.done)break;c=s.value}var f=c;i.push(Ae({name:n,domain:o,win:f},r))}return{cancel:function(){for(var e=i,r=Array.isArray(e),n=0,e=r?e:e[Symbol.iterator]();;){var t;if(r){if(n>=e.length)break;t=e[n++]}else{if(n=e.next(),n.done)break;t=n.value}t.cancel()}}}}if(Array.isArray(o)){for(var l=[],d=o,h=Array.isArray(d),p=0,d=h?d:d[Symbol.iterator]();;){var w;if(h){if(p>=d.length)break;w=d[p++]}else{if(p=d.next(),p.done)break;w=p.value}var y=w;l.push(Ae({name:n,win:t,domain:y},r))}return{cancel:function(){for(var e=l,r=Array.isArray(e),n=0,e=r?e:e[Symbol.iterator]();;){var t;if(r){if(n>=e.length)break;t=e[n++]}else{if(n=e.next(),n.done)break;t=n.value}t.cancel()}}}}var m=be({name:n,win:t,domain:o});if(t&&t!==Dr.WILDCARD||(t=Yr.WINDOW_WILDCARD),o=o||Dr.WILDCARD,m)throw t&&o?new Error("Request listener already exists for "+n+" on domain "+o.toString()+" for specified window"):t?new Error("Request listener already exists for "+n+" for specified window"):o?new Error("Request listener already exists for "+n+" on domain "+o.toString()):new Error("Request listener already exists for "+n);var v=Yr.requestListeners,E=v[n];E||(E=new Lr,v[n]=E);var _=E.get(t);_||(_={},E.set(t,_));var O=o.toString(),g=_[zr],S=void 0;return $(o)?(g||(g=[],_[zr]=g),S={regex:o,listener:r},g.push(S)):_[O]=r,{cancel:function(){_&&(delete _[O],t&&0===Object.keys(_).length&&E.delete(t),S&&g.splice(g.indexOf(S,1)))}}}function Pe(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function Te(e){var r=void 0;try{r=ne(e)}catch(e){return}if(r&&"object"===(void 0===r?"undefined":Vr(r))&&null!==r&&(r=r[Dr.WINDOW_PROPS.POSTROBOT])&&"object"===(void 0===r?"undefined":Vr(r))&&null!==r&&r.type&&"string"==typeof r.type&&Xr[r.type])return r}function Re(e){if(!window||window.closed)throw new Error("Message recieved in closed window");try{if(!e.source)return}catch(e){return}var r=e.source,n=e.origin,t=e.data,o=Te(t);if(o){if(!o.sourceDomain||"string"!=typeof o.sourceDomain)throw new Error("Expected message to have sourceDomain");if(0!==o.sourceDomain.indexOf(Dr.MOCK_PROTOCOL)&&0!==o.sourceDomain.indexOf(Dr.FILE_PROTOCOL)||(n=o.sourceDomain),-1===Yr.receivedMessages.indexOf(o.id)){Yr.receivedMessages.push(o.id);var i=void 0;if(i=-1!==Mr.indexOf(o.name)||o.type===Dr.POST_MESSAGE_TYPE.ACK?"debug":"error"===o.ack?"error":"info",Hr.logLevel(i,["\n\n\t","#receive",o.type.replace(/^postrobot_message_/,""),"::",o.name,"::",n,"\n\n",o]),W(r))return void Hr.debug("Source window is closed - can not send "+o.type+" "+o.name);o.data&&(o.data=we(r,n,o.data)),Xr[o.type](r,n,o)}}}function ke(e){try{e.source}catch(e){return}var r={source:e.source||e.sourceElement,origin:e.origin||e.originalEvent&&e.originalEvent.origin,data:e.data};Re(r)}function Le(){K(window,"message",ke)}function Ie(e){var r=Yr.requestPromises.get(e);if(r)for(var n=r,t=Array.isArray(n),o=0,n=t?n:n[Symbol.iterator]();;){var i;if(t){if(o>=n.length)break;i=n[o++]}else{if(o=n.next(),o.done)break;i=o.value}var a=i;a.reject(new Error("No response from window - cleaned up"))}Yr.popupWindowsByWin&&Yr.popupWindowsByWin.delete(e),Yr.remoteWindows&&Yr.remoteWindows.delete(e),Yr.requestPromises.delete(e),Yr.methods.delete(e),Yr.readyPromises.delete(e)}function Ce(e){return gr.try(function(){if(!e.name)throw new Error("Expected options.name");var r=e.name,n=void 0,t=void 0;if("string"==typeof e.window){var o=document.getElementById(e.window);if(!o)throw new Error("Expected options.window "+Object.prototype.toString.call(e.window)+" to be a valid element id");if("iframe"!==o.tagName.toLowerCase())throw new Error("Expected options.window "+Object.prototype.toString.call(e.window)+" to be an iframe");if(!o.contentWindow)throw new Error("Iframe must have contentWindow.  Make sure it has a src attribute and is in the DOM.");n=o.contentWindow}else if(e.window instanceof HTMLIFrameElement){if("iframe"!==e.window.tagName.toLowerCase())throw new Error("Expected options.window "+Object.prototype.toString.call(e.window)+" to be an iframe");if(e.window&&!e.window.contentWindow)throw new Error("Iframe must have contentWindow.  Make sure it has a src attribute and is in the DOM.");e.window&&e.window.contentWindow&&(n=e.window.contentWindow)}else n=e.window;if(!n)throw new Error("Expected options.window to be a window object, iframe, or iframe element id.");var i=n;t=e.domain||Dr.WILDCARD;var a=e.name+"_"+J();if(W(i))throw new Error("Target window is closed");var u=!1,s=Yr.requestPromises.get(i);s||(s=[],Yr.requestPromises.set(i,s));var c=gr.try(function(){if(G(window,i))return gr.resolve(me(i))}).then(function(){return new gr(function(n,o){var f={name:r,window:i,domain:t,respond:function(e,r){e||(u=!0,s.splice(s.indexOf(c,1))),e?o(e):n(r)}};if(Oe(a,f),_e(i,{type:Dr.POST_MESSAGE_TYPE.REQUEST,hash:a,name:r,data:e.data,fireAndForget:e.fireAndForget},t).catch(o),e.fireAndForget)return n();var l=Wr.ACK_TIMEOUT,d=e.timeout||Wr.RES_TIMEOUT,h=100,p=function n(){if(!u){if(W(i))return o(f.ack?new Error("Window closed for "+r+" before response"):new Error("Window closed for "+r+" before ack"));l-=h,d-=h;if(f.ack){if(d===1/0)return;h=Math.min(d,2e3)}else{if(l<=0)return o(new Error("No ack for postMessage "+r+" in "+Wr.ACK_TIMEOUT+"ms"));if(d<=0)return o(new Error("No response for postMessage "+r+" in "+(e.timeout||Wr.RES_TIMEOUT)+"ms"))}setTimeout(n,h)}};setTimeout(p,h)})});return c.catch(function(){Se(a)}),s.push(c),c})}function je(e,r,n,t){return t=t||{},t.window=e,t.name=r,t.data=n,Ce(t)}function xe(e,r,n){var t=N();return t?je(t,e,r,n):new gr(function(e,r){return r(new Error("Window does not have a parent"))})}function De(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!e.window)throw new Error("Expected options.window");var r=e.window;return{send:function(n,t){return je(r,n,t,e)}}}function Me(e){if(!e.name)throw new Error("Expected options.name");if(!e.handler)throw new Error("Expected options.handler");var r=e.name,n=e.window,t=e.domain,o={handler:e.handler,handleError:e.errorHandler||function(e){throw e},window:n,domain:t||Dr.WILDCARD,name:r},i=Ae({name:r,win:n,domain:t},o);if(e.once){var a=o.handler;o.handler=Gr(function(){return i.cancel(),a.apply(this,arguments)})}if(o.window&&e.errorOnClose)var u=V(function(){n&&"object"===(void 0===n?"undefined":$r(n))&&W(n)&&(u.cancel(),o.handleError(new Error("Post message target window is closed")))},50);return{cancel:function(){i.cancel()}}}function We(e,r,n){return"function"==typeof r&&(n=r,r={}),r=r||{},r.name=e,r.handler=n||r.handler,Me(r)}function Ne(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments[2];"function"==typeof r&&(n=r,r={}),r=r||{},n=n||r.handler;var t=r.errorHandler,o=new gr(function(o,i){r=r||{},r.name=e,r.once=!0,r.handler=function(e){if(o(e),n)return n(e)},r.errorHandler=function(e){if(i(e),t)return t(e)}}),i=Me(r);return o.cancel=i.cancel,o}function Ge(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{on:function(r,n){return We(r,e,n)}}}function qe(){delete window[Dr.WINDOW_PROPS.POSTROBOT],window.removeEventListener("message",ke)}function Ue(){Yr.initialized||(Le(),ye(),Br()),Yr.initialized=!0}function He(e){var r={};if(!e)return r;for(var n=Array.from(e.keys()),t=Array.isArray(n),o=0,n=t?n:n[Symbol.iterator]();;){var i;if(t){if(o>=n.length)break;i=n[o++]}else{if(o=n.next(),o.done)break;i=o.value}var a=i;r[a.toLowerCase()]=e.get(a)}return r}function Ye(e){return new Headers(e||{})}function Fe(e,r){var n={};if(!e)return n;for(var t=Object.keys(e),o=Array.isArray(t),i=0,t=o?t:t[Symbol.iterator]();;){var a;if(o){if(i>=t.length)break;a=t[i++]}else{if(i=t.next(),i.done)break;a=i.value}var u=a;r(u)&&(n[u]=e[u])}return n}function Be(e,r){return Fe(e,function(e){return-1!==r.indexOf(e)})}function Ke(e,r){return Fe(e,function(e){return r.test(e)})}function Je(e,r){return Fe(e,function(e){return e===r})}function Ze(e){return"[object RegExp]"===Object.prototype.toString.call(e)}function ze(e){var r=Be(e,sn);return r.method&&(r.method=r.method.toLowerCase()),e&&e.headers&&(r.headers=He(e.headers)),r}function Qe(e){return e.text().then(function(r){return r=r||null,new window.Response(r,{status:e.status,statusText:e.statusText,headers:Ye(e.headers)})})}function Xe(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return je(e,nn,{url:r,options:ze(n)}).then(function(e){return Qe(e.data)})}function Ve(e){var r=e.location;if(!r)throw new Error("Can not read window location");var n=r.protocol;if(!n)throw new Error("Can not read window protocol");if(n===fn.FILE_PROTOCOL)return"file://";var t=r.host;if(!t)throw new Error("Can not read window host");return n+"//"+t}function $e(e){e=e||window;var r=Ve(e);return r&&e.mockDomain&&0===e.mockDomain.indexOf(fn.MOCK_PROTOCOL)?e.mockDomain:r}function er(e){var r=void 0;return e.match(/^(https?|mock|file):\/\//)?(r=e,r=r.split("/").slice(0,3).join("/")):$e()}function rr(e){var r=er(e);if(!ln[r]){var n=document.createElement("iframe");n.style.display="none",n.setAttribute("src",e);var t=document.body||document.head;if(!t)throw new Error("Could not find suitable container for proxy iframe");t.appendChild(n),ln[r]=n}return ln[r]}function nr(){for(var e=Object.keys(ln),r=Array.isArray(e),n=0,e=r?e:e[Symbol.iterator]();;){var t;if(r){if(n>=e.length)break;t=e[n++]}else{if(n=e.next(),n.done)break;t=n.value}var o=t,i=ln[o];i.parentNode.removeChild(i),delete ln[o]}}function tr(e){var r=e.url,n=rr(r).contentWindow;return{fetch:function(e,r){return Xe(n,e,r)}}}function or(e,r){if("string"!=typeof r&&!(Ze(r)||Array.isArray(r)&&r.every(function(e){return"string"==typeof e})))throw new Error("Invalid matcher for "+e+": "+Object.prototype.toString.call(r))}function ir(e,r){if(r===tn)return e;if(Array.isArray(r))return Be(e,r);if(Ze(r))return Ke(e,r);if("string"==typeof r)return Je(e,r);throw new Error("Invalid matcher")}function ar(e){for(var r=e,n=Array.isArray(r),t=0,r=n?r:r[Symbol.iterator]();;){var o;if(n){if(t>=r.length)break;o=r[t++]}else{if(t=r.next(),t.done)break;o=t.value}for(var i=o,a=Object.keys(i),u=Array.isArray(a),s=0,a=u?a:a[Symbol.iterator]();;){var c;if(u){if(s>=a.length)break;c=a[s++]}else{if(s=a.next(),s.done)break;c=s.value}var f=c;if(!pn.hasOwnProperty(f))throw new Error("Unexpected rule: "+f);or(f,i[f])}}}function ur(e){return Array.isArray(e)?0===e.length?"[]":"[ "+e.map(function(e){return"'"+e+"'"}).join(", ")+" ]":"'"+e+"'"}function sr(e){return"string"==typeof e?"[ '"+e+"' ]":Array.isArray(e)?0===e.length?"[]":"[ "+e.map(function(e){return"'"+e+"'"}).join(", ")+" ]":Ze(e)?"/"+e.source+"/":e.toString()}function cr(e,r){return Array.isArray(e)?e.every(function(e){return cr(e,r)}):"string"==typeof r?r===tn||e===r:Ze(r)?r.test(e):!!Array.isArray(r)&&r.some(function(r){return r===e})}function fr(e){var r=new hn.a(e,window.mockDomain||window.location,!0);return{domain:r.protocol+"//"+r.host,path:r.pathname,query:r.query}}function lr(e,r,n,t){for(var o=fr(r),i=o.domain,a=o.path,u=o.query,s=[],c=t,f=Array.isArray(c),l=0,c=f?c:c[Symbol.iterator]();;){var d;if(f){if(l>=c.length)break;d=c[l++]}else{if(l=c.next(),l.done)break;d=l.value}for(var h=d,p=[],w=[{name:"origin",value:e},{name:"domain",value:i},{name:"method",value:n.method||"get"},{name:"path",value:a},{name:"query",value:Object.keys(u)},{name:"headers",value:Object.keys(n.headers||{})},{name:"credentials",value:n.credentials||cn.OMIT},{name:"options",value:Object.keys(n)}],y=w,m=Array.isArray(y),v=0,y=m?y:y[Symbol.iterator]();;){var E;if(m){if(v>=y.length)break;E=y[v++]}else{if(v=y.next(),v.done)break;E=v.value}var _=E,O=_.name,g=_.value,S=h.hasOwnProperty(O)?h[O]:pn[O];cr(g,S)||p.push({name:O,value:g,matcher:S})}if(!p.length)return h;s.push(p)}var b=s.map(function(e){return e.map(function(e){var r=e.name,n=e.value,t=e.matcher;return"- "+r+" :: got "+ur(n)+" - expected "+sr(t)}).join("\n")}).join("\n\n");throw new Error("Failed to find matching rule for request:\n\n"+b+"\n")}function dr(e,r){return ir(e,r.responseHeaders||pn.responseHeaders||[])}function hr(e){var r=Be(e,sn);return e&&e.headers&&(r.headers=Ye(e.headers)),r}function pr(e){return{status:e.status,statusText:e.statusText,text:e.text.bind(e),headers:He(e.headers)}}function wr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.allow,n=void 0===r?[]:r;0===n.length&&(n=[pn]),ar(n);var t=We(nn,{},function(e){var r=e.origin,t=e.data,o=t.url,i=t.options,a=lr(r,o,i,n);return window.fetch(o,hr(i)).then(function(e){var r=pr(e);return r.headers=dr(r.headers,a),r})});return wn.push(t),{cancel:t.cancel}}function yr(){for(var e=wn,r=Array.isArray(e),n=0,e=r?e:e[Symbol.iterator]();;){var t;if(r){if(n>=e.length)break;t=e[n++]}else{if(n=e.next(),n.done)break;t=n.value}t.cancel()}}function mr(){nr(),yr()}Object.defineProperty(r,"__esModule",{value:!0});var vr={};n.d(vr,"WeakMap",function(){return Lr});var Er={};n.d(Er,"cleanUpWindow",function(){return Ie}),n.d(Er,"init",function(){return Ue}),n.d(Er,"Promise",function(){return gr}),n.d(Er,"parent",function(){return en}),n.d(Er,"bridge",function(){return rn}),n.d(Er,"send",function(){return je}),n.d(Er,"request",function(){return Ce}),n.d(Er,"sendToParent",function(){return xe}),n.d(Er,"client",function(){return De}),n.d(Er,"on",function(){return We}),n.d(Er,"listen",function(){return Me}),n.d(Er,"once",function(){return Ne}),n.d(Er,"listener",function(){return Ge}),n.d(Er,"CONFIG",function(){return Wr}),n.d(Er,"CONSTANTS",function(){return Dr}),n.d(Er,"disable",function(){return qe});var _r,Or=function(){function e(e,r){for(var n=0;n<r.length;n++){var t=r[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(r,n,t){return n&&e(r.prototype,n),t&&e(r,t),r}}(),gr=function(){function e(r){var n=this;if(u(this,e),this.resolved=!1,this.rejected=!1,this.errorHandled=!1,this.handlers=[],r){var t=void 0,o=void 0,i=!1,a=!1,s=!1;try{r(function(e){s?n.resolve(e):(i=!0,t=e)},function(e){s?n.reject(e):(a=!0,o=e)})}catch(e){return void this.reject(e)}s=!0,i?this.resolve(t):a&&this.reject(o)}}return Or(e,[{key:"resolve",value:function(e){if(this.resolved||this.rejected)return this;if(t(e))throw new Error("Can not resolve promise with another promise");return this.resolved=!0,this.value=e,this.dispatch(),this}},{key:"reject",value:function(e){var r=this;if(this.resolved||this.rejected)return this;if(t(e))throw new Error("Can not reject promise with another promise");if(!e){var n=e&&"function"==typeof e.toString?e.toString():Object.prototype.toString.call(e);e=new Error("Expected reject to be called with Error, got "+n)}return this.rejected=!0,this.error=e,this.errorHandled||setTimeout(function(){r.errorHandled||i(e)},1),this.dispatch(),this}},{key:"asyncReject",value:function(e){this.errorHandled=!0,this.reject(e)}},{key:"dispatch",value:function(){var r=this,n=this.dispatching,i=this.resolved,a=this.rejected,u=this.handlers;if(!n&&(i||a)){this.dispatching=!0,o().activeCount+=1;for(var s=0;s<u.length;s++){(function(n){var o=u[n],s=o.onSuccess,c=o.onError,f=o.promise,l=void 0;if(i)try{l=s?s(r.value):r.value}catch(e){return f.reject(e),"continue"}else if(a){if(!c)return f.reject(r.error),"continue";try{l=c(r.error)}catch(e){return f.reject(e),"continue"}}l instanceof e&&(l.resolved||l.rejected)?(l.resolved?f.resolve(l.value):f.reject(l.error),l.errorHandled=!0):t(l)?l instanceof e&&(l.resolved||l.rejected)?l.resolved?f.resolve(l.value):f.reject(l.error):l.then(function(e){f.resolve(e)},function(e){f.reject(e)}):f.resolve(l)})(s)}u.length=0,this.dispatching=!1,o().activeCount-=1,0===o().activeCount&&e.flushQueue()}}},{key:"then",value:function(r,n){if(r&&"function"!=typeof r&&!r.call)throw new Error("Promise.then expected a function for success handler");if(n&&"function"!=typeof n&&!n.call)throw new Error("Promise.then expected a function for error handler");var t=new e;return this.handlers.push({promise:t,onSuccess:r,onError:n}),this.errorHandled=!0,this.dispatch(),t}},{key:"catch",value:function(e){return this.then(void 0,e)}},{key:"finally",value:function(r){return this.then(function(n){return e.try(r).then(function(){return n})},function(n){return e.try(r).then(function(){throw n})})}},{key:"timeout",value:function(e,r){var n=this;if(this.resolved||this.rejected)return this;var t=setTimeout(function(){n.resolved||n.rejected||n.reject(r||new Error("Promise timed out after "+e+"ms"))},e);return this.then(function(e){return clearTimeout(t),e})}},{key:"toPromise",value:function(){if(!window.Promise)throw new Error("Could not find window.Promise");return window.Promise.resolve(this)}}],[{key:"resolve",value:function(r){return r instanceof e?r:t(r)?new e(function(e,n){return r.then(e,n)}):(new e).resolve(r)}},{key:"reject",value:function(r){return(new e).reject(r)}},{key:"all",value:function(r){var n=new e,o=r.length,i=[];if(!o)return n.resolve(i),n;for(var a=0;a<r.length;a++){(function(a){var u=r[a];if(u instanceof e){if(u.resolved)return i[a]=u.value,o-=1,"continue"}else if(!t(u))return i[a]=u,o-=1,"continue";e.resolve(u).then(function(e){i[a]=e,0===(o-=1)&&n.resolve(i)},function(e){n.reject(e)})})(a)}return 0===o&&n.resolve(i),n}},{key:"hash",value:function(r){var n={};return e.all(Object.keys(r).map(function(t){return e.resolve(r[t]).then(function(e){n[t]=e})})).then(function(){return n})}},{key:"map",value:function(r,n){return e.all(r.map(n))}},{key:"onPossiblyUnhandledException",value:function(e){return a(e)}},{key:"try",value:function(r,n,t){var o=void 0;try{o=r.apply(n,t||[])}catch(r){return e.reject(r)}return e.resolve(o)}},{key:"delay",value:function(r){return new e(function(e){setTimeout(e,r)})}},{key:"isPromise",value:function(r){return!!(r&&r instanceof e)||t(r)}},{key:"flush",value:function(){var r=new e;return o().flushPromises.push(r),0===o().activeCount&&e.flushQueue(),r}},{key:"flushQueue",value:function(){var e=o().flushPromises;o().flushPromises=[];for(var r=e,n=Array.isArray(r),t=0,r=n?r:r[Symbol.iterator]();;){var i;if(n){if(t>=r.length)break;i=r[t++]}else{if(t=r.next(),t.done)break;i=t.value}i.resolve()}}}]),e}(),Sr={MOCK_PROTOCOL:"mock:",FILE_PROTOCOL:"file:",WILDCARD:"*"},br="Call was rejected by callee.\r\n",Ar=[],Pr=[],Tr=function(){function e(e,r){for(var n=0;n<r.length;n++){var t=r[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(r,n,t){return n&&e(r.prototype,n),t&&e(r,t),r}}(),Rr=Object.defineProperty,kr=Date.now()%1e9,Lr=function(){function e(){if(_(this,e),kr+=1,this.name="__weakmap_"+(1e9*Math.random()>>>0)+"__"+kr,v())try{this.weakmap=new window.WeakMap}catch(e){}this.keys=[],this.values=[]}return Tr(e,[{key:"_cleanupClosedWindows",value:function(){for(var e=this.weakmap,r=this.keys,n=0;n<r.length;n++){var t=r[n];if(m(t)&&y(t)){if(e)try{e.delete(t)}catch(e){}r.splice(n,1),this.values.splice(n,1),n-=1}}}},{key:"isSafeToReadWrite",value:function(e){if(m(e))return!1;try{e&&e.self,e&&e[this.name]}catch(e){return!1}return!0}},{key:"set",value:function(e,r){if(!e)throw new Error("WeakMap expected key");var n=this.weakmap;if(n)try{n.set(e,r)}catch(e){delete this.weakmap}if(this.isSafeToReadWrite(e)){var t=this.name,o=e[t];o&&o[0]===e?o[1]=r:Rr(e,t,{value:[e,r],writable:!0})}else{this._cleanupClosedWindows();var i=this.keys,a=this.values,u=E(i,e);-1===u?(i.push(e),a.push(r)):a[u]=r}}},{key:"get",value:function(e){if(!e)throw new Error("WeakMap expected key");var r=this.weakmap;if(r)try{if(r.has(e))return r.get(e)}catch(e){delete this.weakmap}if(!this.isSafeToReadWrite(e)){this._cleanupClosedWindows();var n=this.keys,t=E(n,e);if(-1===t)return;return this.values[t]}var o=e[this.name];if(o&&o[0]===e)return o[1]}},{key:"delete",value:function(e){if(!e)throw new Error("WeakMap expected key");var r=this.weakmap;if(r)try{r.delete(e)}catch(e){delete this.weakmap}if(this.isSafeToReadWrite(e)){var n=e[this.name];n&&n[0]===e&&(n[0]=n[1]=void 0)}else{this._cleanupClosedWindows();var t=this.keys,o=E(t,e);-1!==o&&(t.splice(o,1),this.values.splice(o,1))}}},{key:"has",value:function(e){if(!e)throw new Error("WeakMap expected key");var r=this.weakmap;if(r)try{return r.has(e)}catch(e){delete this.weakmap}if(this.isSafeToReadWrite(e)){var n=e[this.name];return!(!n||n[0]!==e)}return this._cleanupClosedWindows(),-1!==E(this.keys,e)}}]),e}(),Ir={MOCK_PROTOCOL:"mock:",FILE_PROTOCOL:"file:",WILDCARD:"*"},Cr="Call was rejected by callee.\r\n",jr=[],xr=[],Dr={POST_MESSAGE_TYPE:{REQUEST:"postrobot_message_request",RESPONSE:"postrobot_message_response",ACK:"postrobot_message_ack"},POST_MESSAGE_ACK:{SUCCESS:"success",ERROR:"error"},POST_MESSAGE_NAMES:{METHOD:"postrobot_method",READY:"postrobot_ready",OPEN_TUNNEL:"postrobot_open_tunnel"},WINDOW_TYPES:{FULLPAGE:"fullpage",POPUP:"popup",IFRAME:"iframe"},WINDOW_PROPS:{POSTROBOT:"__postRobot__"},SERIALIZATION_TYPES:{METHOD:"postrobot_method",ERROR:"postrobot_error",PROMISE:"postrobot_promise",ZALGO_PROMISE:"postrobot_zalgo_promise",REGEX:"regex"},SEND_STRATEGIES:{POST_MESSAGE:"postrobot_post_message",BRIDGE:"postrobot_bridge",GLOBAL:"postrobot_global"},MOCK_PROTOCOL:"mock:",FILE_PROTOCOL:"file:",BRIDGE_NAME_PREFIX:"__postrobot_bridge__",POSTROBOT_PROXY:"__postrobot_proxy__",WILDCARD:"*"},Mr=Object.keys(Dr.POST_MESSAGE_NAMES).map(function(e){return Dr.POST_MESSAGE_NAMES[e]}),Wr={ALLOW_POSTMESSAGE_POPUP:!0,LOG_LEVEL:"info",BRIDGE_TIMEOUT:5e3,ACK_TIMEOUT:1e3,RES_TIMEOUT:1/0,LOG_TO_PAGE:!1,ALLOWED_POST_MESSAGE_METHODS:(_r={},Y(_r,Dr.SEND_STRATEGIES.POST_MESSAGE,!0),Y(_r,Dr.SEND_STRATEGIES.BRIDGE,!0),Y(_r,Dr.SEND_STRATEGIES.GLOBAL,!0),_r)};0===window.location.href.indexOf(Dr.FILE_PROTOCOL)&&(Wr.ALLOW_POSTMESSAGE_POPUP=!0);var Nr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gr=function(e){if(!e)return e;var r=!1;return function(){if(!r)return r=!0,e.apply(this,arguments)}},qr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ur=["debug","info","warn","error"];Function.prototype.bind&&window.console&&"object"===qr(console.log)&&["log","info","warn","error"].forEach(function(e){console[e]=this.bind(console[e],console)},Function.prototype.call);var Hr={clearLogs:function(){if(window.console&&window.console.clear&&window.console.clear(),Wr.LOG_TO_PAGE){var e=document.getElementById("postRobotLogs");e&&e.parentNode&&e.parentNode.removeChild(e)}},writeToPage:function(e,r){setTimeout(function(){var n=document.getElementById("postRobotLogs");n||(n=document.createElement("div"),n.id="postRobotLogs",n.style.cssText="width: 800px; font-family: monospace; white-space: pre-wrap;",document.body&&document.body.appendChild(n));var t=document.createElement("div"),o=(new Date).toString().split(" ")[4],i=Array.prototype.slice.call(r).map(function(e){if("string"==typeof e)return e;if(!e)return Object.prototype.toString.call(e);var r=void 0;try{r=re(e,null,2)}catch(e){r="[object]"}return"\n\n"+r+"\n\n"}).join(" "),a=o+" "+e+" "+i;t.innerHTML=a;var u={log:"#ddd",warn:"orange",error:"red",info:"blue",debug:"#aaa"}[e];t.style.cssText="margin-top: 10px; color: "+u+";",n.childNodes.length?n.insertBefore(t,n.childNodes[0]):n.appendChild(t)})},logLevel:function(e,r){setTimeout(function(){try{var n=window.LOG_LEVEL||Wr.LOG_LEVEL;if(Ur.indexOf(e)<Ur.indexOf(n))return;if(r=Array.prototype.slice.call(r),r.unshift(""+window.location.host+window.location.pathname),r.unshift("::"),r.unshift(""+ee().toLowerCase()),r.unshift("[post-robot]"),Wr.LOG_TO_PAGE&&Hr.writeToPage(e,r),!window.console)return;if(window.console[e]||(e="log"),!window.console[e])return;window.console[e].apply(window.console,r)}catch(e){}},1)},debug:function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];Hr.logLevel("debug",r)},info:function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];Hr.logLevel("info",r)},warn:function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];Hr.logLevel("warn",r)},error:function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];Hr.logLevel("error",r)}},Yr=window[Dr.WINDOW_PROPS.POSTROBOT]=window[Dr.WINDOW_PROPS.POSTROBOT]||{};Yr.registerSelf=function(){};var Fr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Yr.methods=Yr.methods||new Lr;var Br=Gr(function(){We(Dr.POST_MESSAGE_NAMES.METHOD,{origin:Dr.WILDCARD},function(e){var r=e.source,n=e.origin,t=e.data,o=Yr.methods.get(r);if(!o)throw new Error("Could not find any methods this window has privileges to call");var i=o[t.id];if(!i)throw new Error("Could not find method with id: "+t.id);if(!H(i.domain,n))throw new Error("Method domain "+i.domain+" does not match origin "+n);return Hr.debug("Call local method",t.name,t.args),gr.try(function(){return i.method.apply({source:r,origin:n,data:t},t.args)}).then(function(e){return{result:e,id:t.id,name:t.name}})})});Yr.readyPromises=Yr.readyPromises||new Lr;var Kr={};Kr[Dr.SEND_STRATEGIES.POST_MESSAGE]=function(e,r,n){var t=void 0;t=Array.isArray(n)?n:n?[n]:[Dr.WILDCARD],t=t.map(function(r){if(0===r.indexOf(Dr.MOCK_PROTOCOL)){if(window.location.protocol===Dr.FILE_PROTOCOL)return Dr.WILDCARD;if(!P(e))throw new Error("Attempting to send messsage to mock domain "+r+", but window is actually cross-domain");return S(e)}return 0===r.indexOf(Dr.FILE_PROTOCOL)?Dr.WILDCARD:r}),t.forEach(function(n){return e.postMessage(r,n)})};var Jr=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e};Yr.responseListeners=Yr.responseListeners||{},Yr.requestListeners=Yr.requestListeners||{},Yr.WINDOW_WILDCARD=Yr.WINDOW_WILDCARD||new function(){};var Zr,zr="__domain_regex__",Qr=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e},Xr=(Zr={},Pe(Zr,Dr.POST_MESSAGE_TYPE.ACK,function(e,r,n){var t=ge(n.hash);if(!t)throw new Error("No handler found for post message ack for message: "+n.name+" from "+r+" in "+window.location.protocol+"//"+window.location.host+window.location.pathname);if(!H(t.domain,r))throw new Error("Ack origin "+r+" does not match domain "+t.domain.toString());t.ack=!0}),Pe(Zr,Dr.POST_MESSAGE_TYPE.REQUEST,function(e,r,n){function t(t){return n.fireAndForget||W(e)?gr.resolve():_e(e,Qr({target:n.originalSource,hash:n.hash,name:n.name},t),r)}var o=be({name:n.name,win:e,domain:r});return gr.all([t({type:Dr.POST_MESSAGE_TYPE.ACK}),gr.try(function(){if(!o)throw new Error("No handler found for post message: "+n.name+" from "+r+" in "+window.location.protocol+"//"+window.location.host+window.location.pathname);if(!H(o.domain,r))throw new Error("Request origin "+r+" does not match domain "+o.domain.toString());var t=n.data;return o.handler({source:e,origin:r,data:t})}).then(function(e){return t({type:Dr.POST_MESSAGE_TYPE.RESPONSE,ack:Dr.POST_MESSAGE_ACK.SUCCESS,data:e})},function(e){var r=F(e).replace(/^Error: /,"");return t({type:Dr.POST_MESSAGE_TYPE.RESPONSE,ack:Dr.POST_MESSAGE_ACK.ERROR,error:r})})]).then(B).catch(function(e){if(o&&o.handleError)return o.handleError(e);Hr.error(F(e))})}),Pe(Zr,Dr.POST_MESSAGE_TYPE.RESPONSE,function(e,r,n){var t=ge(n.hash);if(!t)throw new Error("No handler found for post message response for message: "+n.name+" from "+r+" in "+window.location.protocol+"//"+window.location.host+window.location.pathname);if(!H(t.domain,r))throw new Error("Response origin "+r+" does not match domain "+t.domain);if(Se(n.hash),n.ack===Dr.POST_MESSAGE_ACK.ERROR)return t.respond(new Error(n.error),null);if(n.ack===Dr.POST_MESSAGE_ACK.SUCCESS){var o=n.data||n.response;return t.respond(null,{source:e,origin:r,data:o})}}),Zr),Vr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Yr.receivedMessages=Yr.receivedMessages||[],Yr.requestPromises=Yr.requestPromises||new Lr;var $r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},en=N(),rn=void 0;Ue();var nn="fetch-robot-proxy",tn="*",on=["get","head","post","put","delete","connect","options","trace","patch"],an=["accept","accept-language","content-language","content-type"],un=["cache-control","content-language","content-type","expires","last-modified","pragma"],sn=["method","body","mode","credentials","cache","redirect","referrer","integrity","headers"],cn={INCLUDE:"include",SAME_ORIGIN:"same-origin",OMIT:"omit"},fn=(cn.INCLUDE,cn.SAME_ORIGIN,cn.OMIT,{MOCK_PROTOCOL:"mock:",FILE_PROTOCOL:"file:",WILDCARD:"*"}),ln={},dn=n("./node_modules/url-parse/index.js"),hn=n.n(dn),pn={origin:tn,domain:$e(),path:[],query:tn,method:on,headers:an,credentials:cn.OMIT,options:sn,responseHeaders:un},wn=[];n.d(r,"connect",function(){return tr}),n.d(r,"serve",function(){return wr}),n.d(r,"destroyAll",function(){return mr}),n.d(r,"WILDCARD",function(){return tn}),n.d(r,"STANDARD_REQUEST_HEADERS",function(){return an}),n.d(r,"STANDARD_RESPONSE_HEADERS",function(){return un})}})});
//# sourceMappingURL=fetch-robot.min.js.map
//# sourceMappingURL=fetch-robot.min.js.map